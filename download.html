<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>ç¤¾æœƒå±€ - åª’é«”ä¸‹è¼‰æ¨¡çµ„</title>
  <style>
    /* æ ¸å¿ƒé˜²ç ´åœ–å±¬æ€§ */
    * { box-sizing: border-box; }

    body { margin: 0; background: #000; color: #0f0; font-family: 'Courier New', monospace; overflow-x: hidden; overflow-y: auto; }
    canvas { position: fixed; top: 0; left: 0; z-index: -1; opacity: 0.35; }

    /* é›»è…¦ç‰ˆï¼šç¶­æŒä½ åŸæœ¬å®Œç¾çš„è¨­å®š */
    .wrap { position:absolute; inset:0; display:grid; place-items:center; padding: 24px; min-height: 100vh; }
    .panel { width: 100%; max-width: 820px; border: 1px solid rgba(0,255,0,0.45); background: rgba(0, 12, 0, 0.55); box-shadow: 0 0 26px rgba(0,255,0,0.14); padding: 18px 18px 16px; backdrop-filter: blur(6px); }

    .topbar { display:flex; align-items:center; justify-content:space-between; gap: 12px; margin-bottom: 15px; }
    .title { font-size: 1.1rem; letter-spacing: 4px; color: #e8ffe8; text-shadow: 0 0 12px rgba(0,255,0,0.35); white-space: nowrap; }
    .badge { font-size: .85rem; padding: 6px 10px; border: 1px solid rgba(0,255,0,0.35); color: rgba(0,255,0,0.85); background: rgba(0,0,0,0.35); white-space: nowrap; }

    .control-group { display: flex; flex-direction: column; gap: 10px; }
    .row-url { display: flex; width: 100%; }
    .row-settings { display: flex; gap: 10px; flex-wrap: wrap; }
    
    input, select { padding: 12px; background: rgba(0,0,0,0.6); color: #0f0; border: 1px solid rgba(0,255,0,0.42); outline: none; font-size: 1rem; font-family: 'Courier New', monospace; }
    input { flex: 1; min-width: 0; }
    select { flex: 1; min-width: 140px; }

    .btn { padding: 12px 14px; border: 1px solid #0f0; background: transparent; color: #0f0; cursor: pointer; font-size: 1rem; transition: .2s; white-space: nowrap; flex: 0 0 auto; }
    .btn:hover { background: rgba(0,255,0,0.16); box-shadow: 0 0 18px rgba(0,255,0,0.45); }
    .btn-submit { flex: 0 0 140px; font-weight: bold; background: rgba(0, 50, 0, 0.5); border-color: #0f0; }

    /* é›»è…¦ç‰ˆè¼”åŠ©æŒ‰éˆ•ï¼šç¶­æŒåŸæœ¬çš„ä¸æ‹‰é•·ã€é å·¦æ’åˆ— */
    .subgrid { display:flex; gap:10px; margin-top: 12px; flex-wrap: wrap; }
    .btn.secondary { border-color: rgba(0,255,0,0.55); color: rgba(0,255,0,0.85); opacity: .9; padding: 10px 14px; }
    .btn.secondary:hover { opacity: 1; }

    .hint { margin-top: 12px; font-size: .92rem; color: rgba(0,255,0,0.72); line-height: 1.5; }
    .result { margin-top: 12px; padding: 12px; border: 1px dashed rgba(0,255,0,0.35); background: rgba(0,0,0,0.38); color: #fff; line-height: 1.6; min-height: 54px; word-break: break-all; }
    .result a { color:#00BFFF; text-decoration:none; }
    .result a:hover { text-decoration:underline; }

    .footer { margin-top: 10px; display:flex; justify-content:space-between; gap:10px; flex-wrap:wrap; font-size: .88rem; color: rgba(0,255,0,0.6); }
    .linklike { cursor:pointer; }
    .linklike:hover { text-decoration: underline; }

    /* ========================================= */
    /* ğŸ“± æ‰‹æ©Ÿç‰ˆå°ˆå±¬çµç•Œ (åªå°è¢å¹•å¯¬åº¦ < 760px ç”Ÿæ•ˆ) */
    /* ========================================= */
    @media (max-width: 760px){
      .wrap { padding: 16px; align-items: flex-start; padding-top: 5vh; }
      
      /* å¼·åˆ¶æ¨™é¡Œèˆ‡å¾½ç« ä¸Šä¸‹ç–Šæ”¾ï¼Œç¸®å°å­—è·ï¼Œçµ•å°ä¸æ’ç ´ */
      .topbar { flex-direction: column; align-items: center; justify-content: center; gap: 10px; }
      .title { font-size: 1rem; letter-spacing: 2px; }
      
      .row-settings { flex-direction: column; }
      .btn-submit { width: 100%; flex: 1; }
      
      /* æ‰‹æ©Ÿç‰ˆè®“ä¸‰é¡†æŒ‰éˆ•è®Šæˆä¸Šä¸‹æ’å¥½é»æ“Š */
      .subgrid { flex-direction: column; }
      .btn.secondary { width: 100%; text-align: center; }
    }
  </style>
</head>
<body>
  <canvas id="matrix"></canvas>

  <div class="wrap">
    <div class="panel">
      <div class="topbar">
        <div class="title">ã€ åª’ é«” ä¸‹ è¼‰ æ¨¡ çµ„ ã€‘</div>
        <div class="badge">SECURE CHANNEL</div>
      </div>

      <div class="control-group">
        <div class="row-url">
          <input id="url" placeholder="è²¼ä¸Šåª’é«”ç¶²å€ï¼ˆæˆ–ç›´é€£ mp3/mp4ï¼‰" />
        </div>
        <div class="row-settings">
          <select id="type" onchange="toggleOptions()">
            <option value="video">ğŸï¸ æ ¼å¼ï¼šå½±ç‰‡ MP4</option>
            <option value="audio">ğŸµ æ ¼å¼ï¼šéŸ³æª” MP3</option>
          </select>
          
          <select id="res_select">
            <option value="best">æœ€é«˜ç•«è³ª (ç„¡ä¸Šé™, æ”¯æ´8K/4K)</option>
            <option value="1080">é™åˆ¶ 1080p (FHD)</option>
            <option value="720">é™åˆ¶ 720p (HD)</option>
            <option value="480">é™åˆ¶ 480p (SD)</option>
          </select>

          <select id="audio_select" style="display:none;">
            <option value="320">ç„¡æç´š 320 kbps</option>
            <option value="192" selected>é«˜éŸ³è³ª 192 kbps</option>
            <option value="128">æ¨™æº–éŸ³è³ª 128 kbps</option>
          </select>

          <button class="btn btn-submit" onclick="go()">é–‹å§‹è™•ç†</button>
        </div>
      </div>

      <div class="subgrid">
        <button class="btn secondary" onclick="fillExample('direct')">å¡«å…¥ï¼šç›´é€£</button>
        <button class="btn secondary" onclick="fillExample('other')">å¡«å…¥ï¼šä¸€èˆ¬ç¶²å€</button>
        <button class="btn secondary" onclick="history.back()">â† è¿”å›ä¸Šä¸€é </button>
      </div>

      <div class="hint">
        âœ” è‹¥ä½ è²¼çš„æ˜¯ <b>mp3/mp4 ç›´é€£</b>ï¼šæœƒç›´æ¥çµ¦ä½ ä¸‹è¼‰é€£çµã€‚<br/>
        âœ” è‹¥è·³å‡ºã€ŒVisit Siteã€è­¦å‘Šé é¢ï¼Œåªéœ€é»æ“Šæ”¾è¡Œä¸€æ¬¡å³å¯ã€‚
      </div>

      <div class="result" id="result">ç‹€æ…‹ï¼šç­‰å¾…è¼¸å…¥â€¦</div>

      <div class="footer">
        <div>TIPï¼šæ”¯æ´å‹•æ…‹ç•«è³ª/éŸ³è³ªåƒæ•¸å‚³é</div>
        <div class="linklike" onclick="copyLink()">è¤‡è£½æœ¬é é€£çµ</div>
      </div>
    </div>
  </div>

  <script>
    const canvas = document.getElementById("matrix");
    const ctx = canvas.getContext("2d");
    function resize(){ canvas.width = innerWidth; canvas.height = innerHeight; }
    resize(); addEventListener("resize", resize);

    const letters = "01010101COMPUTER-IDENTIFIED-ACCESS-DENIED-WELCOME-BACK".split("");
    const fontSize = 16;
    function initDrops(){
      const cols = canvas.width / fontSize;
      return Array(Math.floor(cols)).fill(1);
    }
    let drops = initDrops();
    addEventListener("resize", () => drops = initDrops());

    setInterval(() => {
      ctx.fillStyle = "rgba(0, 0, 0, 0.06)";
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      ctx.fillStyle = "#0f0";
      ctx.font = fontSize + "px monospace";
      drops.forEach((y, i) => {
        const t = letters[Math.floor(Math.random() * letters.length)];
        ctx.fillText(t, i * fontSize, y * fontSize);
        if (y * fontSize > canvas.height && Math.random() > 0.975) drops[i] = 0;
        drops[i]++;
      });
    }, 50);

    function toggleOptions() {
      const type = document.getElementById("type").value;
      if (type === "video") {
        document.getElementById("res_select").style.display = "inline-block";
        document.getElementById("audio_select").style.display = "none";
      } else {
        document.getElementById("res_select").style.display = "none";
        document.getElementById("audio_select").style.display = "inline-block";
      }
    }

    function setResult(html){ document.getElementById("result").innerHTML = html; }

    function go(){
      const url = document.getElementById("url").value.trim();
      const type = document.getElementById("type").value;
      const resolution = document.getElementById("res_select").value;
      const audio_quality = document.getElementById("audio_select").value;

      if(!url){ setResult("âš ï¸ ç‹€æ…‹ï¼šè«‹æä¾›æœ‰æ•ˆç¶²å€"); return; }

      const direct = /\.(mp3|mp4|m4a|wav|flac)(\?.*)?$/i.test(url);
      if(direct){
        setResult(`âœ… ç‹€æ…‹ï¼šç›´é€£æª”æ¡ˆåµæ¸¬æˆåŠŸ<br/>â¡ï¸ <a href="${url}" target="_blank" rel="noopener">é»æˆ‘ä¸‹è¼‰ / é–‹å•Ÿ</a>`);
        return;
      }

      const NAS_HOST = "kole-superaccurate-louetta.ngrok-free.dev";
      const API_URL = `https://${NAS_HOST}/api/download`;
      
      setResult("â³ ç‹€æ…‹ï¼šä¼ºæœå™¨æ­£åœ¨è™•ç†ä¸­ (è‹¥å½±ç‰‡ç•«è³ªæ¥µé«˜ï¼Œç¸«åˆèˆ‡å‚³è¼¸éœ€è€—æ™‚æ•¸åˆ†é˜ï¼Œè«‹æ”¾è‘—è®“å®ƒè·‘)...");

      fetch(API_URL, {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            "ngrok-skip-browser-warning": "true" 
        },
        body: JSON.stringify({ url, type, resolution, audio_quality })
      })
      .then(r => r.json())
      .then(data => {
        if(!data.ok) throw new Error(data.error || "ä¸‹è¼‰å¤±æ•—");
        const fullDownloadUrl = `https://${NAS_HOST}${data.download_url}`;
        setResult(`âœ… ç‹€æ…‹ï¼šè™•ç†å®Œæˆï¼<br/>â¡ï¸ <a href="${fullDownloadUrl}" target="_blank" rel="noopener">ğŸ“¥ é»æˆ‘å°‡æª”æ¡ˆä¸‹è¼‰è‡³æœ¬æ©Ÿè£ç½®</a><br/><span style="font-size:0.8rem; color:#888;">(è‹¥è·³å‡º Ngrok è­¦å‘Šï¼Œè«‹é»æ“Š Visit Site æ”¾è¡Œ)</span>`);
      })
      .catch(err => {
        setResult(`âŒ ç‹€æ…‹ï¼šç„¡æ³•é€£ç·šè‡³ä¸‹è¼‰æœå‹™<br/>åŸå› ï¼š${err.message}`);
      });
    }

    function fillExample(kind){
      if(kind === "direct"){
        document.getElementById("url").value = "https://example.com/sample.mp3";
        document.getElementById("type").value = "audio";
        toggleOptions();
      } else {
        document.getElementById("url").value = "https://www.youtube.com/watch?v=dQw4w9WgXcQ";
        document.getElementById("type").value = "video";
        toggleOptions();
      }
      setResult("ç‹€æ…‹ï¼šå·²å¡«å…¥ç¤ºä¾‹ï¼ŒæŒ‰ã€é–‹å§‹è™•ç†ã€å³å¯ã€‚");
    }

    async function copyLink(){
      try{
        await navigator.clipboard.writeText(location.href);
        setResult("âœ… ç‹€æ…‹ï¼šå·²è¤‡è£½æœ¬é é€£çµåˆ°å‰ªè²¼ç°¿");
      }catch(e){
        setResult("âš ï¸ ç‹€æ…‹ï¼šç€è¦½å™¨ä¸å…è¨±è¤‡è£½ï¼ˆå¯æ‰‹å‹•è¤‡è£½ç¶²å€åˆ—ï¼‰");
      }
    }
  </script>
</body>
</html>
